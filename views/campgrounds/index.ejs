<% layout('./layouts/boilerplate') %>
    <div id="cluster-map"></div>
    <h1>All Campgrounds</h1>

<!-- JANKY WAY TO MAKE A GRID -->
<div class="container text-left mb-3">
    <% for (let i = 0; i < 4; i++) { %>
        <div class="row">
        <% for (let j = 0; j < 3; j++) {%>
            <% let campground = campgrounds[i*3 + j]; %>
                <div class="col md-4">
                    <% if (campground) {%>
                    <div class="card p-3 mb-3">
                        <a class="card-link" href="/campgrounds/<%=campground._id%>">
                            <img class="img-fluid mb-3" src="<%=campground.images[0].url %>" alt="campground thumbnail">
                            <h5 class="card-title"><%=campground.title %></h5>
                            <p class="card-text text-muted"><%=campground.location%> </p></a>
                    </div>
                    <% } %>
                </div>
            <% } %>
        </div>
        
    <%} %>
</div>


<nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
        <li class="page-item"><a class="page-link <%= currentPage === 1 ? "disabled" : "" %>" href="/campgrounds?page=<%=currentPage - 1 %>">Previous</a></li>
        <% const pageSpacing = 2; %>
        <% if (currentPage - 1 > pageSpacing) {%>
            <li class="page-item"><a class="page-link">...</a></li>
        <% } %>

        <% for (let i = Math.max(1, currentPage - pageSpacing); i <= Math.min(numPages, currentPage + pageSpacing); i++) { %>
            <li class="page-item"><a class="page-link <%= i == currentPage ? "active": ""%>" href="/campgrounds?page=<%=i %>"><%=i %></a></li>
        <% } %>

        <% if (numPages - currentPage > pageSpacing) { %>
            <li class="page-item"><a class="page-link">...</a></li>
        <% } %>
        <li class="page-item"><a class="page-link <%= currentPage === numPages ? "disabled" : "" %>" href="/campgrounds?page=<%=currentPage + 1 %>">Next</a></li>
    </ul>
</nav>
<script>
    const mapToken = '<%-process.env.MAPBOX_TOKEN%>';
    const geoCampgrounds = <%- JSON.stringify(geoCampgrounds) %>
</script>

<script src="/js/clusterMap.js"></script>